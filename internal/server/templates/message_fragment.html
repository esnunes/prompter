{{range .Messages}}
<div class="message message-{{.Role}}">
  <div class="message-bubble">{{.Content}}</div>
</div>
{{end}}

{{if .Question}}
<div class="question-block" id="question-form">
  <h4>{{.Question.Text}}</h4>
  <form hx-post="/prompt-requests/{{.PromptRequestID}}/messages"
        hx-target="#conversation"
        hx-swap="beforeend"
        hx-disabled-elt="find button"
        hx-on::after-request="this.closest('.question-block').remove(); document.getElementById('conversation').scrollTop = document.getElementById('conversation').scrollHeight;">
    <div class="options-list">
      {{range .Question.Options}}
      <label class="option-item">
        <input type="radio" name="message" value="{{.Label}}" required>
        <div>
          <div class="option-label">{{.Label}}</div>
          <div class="option-description">{{.Description}}</div>
        </div>
      </label>
      {{end}}
    </div>
    <div class="mt-4">
      <button type="submit" class="btn btn-primary">Answer</button>
    </div>
    <div class="htmx-indicator"><div class="spinner"></div> Thinking...</div>
  </form>
</div>
{{end}}

{{if .PromptReady}}
<div class="prompt-ready">
  <p>Prompt is ready to publish!</p>
  <form hx-post="/prompt-requests/{{.PromptRequestID}}/publish"
        hx-target="body"
        hx-swap="innerHTML">
    <button type="submit" class="btn btn-primary">Publish to GitHub</button>
    <div class="htmx-indicator"><div class="spinner"></div> Publishing...</div>
  </form>
</div>
{{end}}
